@{
    Layout = "~/_MainLayout.cshtml";
    Page.Title = "Studenten toevoegen";
    var db = Database.Open("database");
    var students = db.Query ("SELECT * FROM students");
    ExcelToDb t = new ExcelToDb();

    if (IsPost)
    {  
            
        var file = Request.Files["Excelfile"];
        var filename = Path.GetFileName(file.FileName); 
        var filePath = Server.MapPath("~/Content/Upload/");
        file.SaveAs(filePath + filename);

        t.LoadeExcelToDb(filePath + filename);


    }
}


<!--<form >
  <input type="file" name="Excelfile" >
  <input type="submit" id="Submit" name="Submit" value="Submit"/>  
</form>
-->
<div id="content">
    Gebruiker moet het volgende op zijn computer hebben wil de import slagen!:<br>
    Microsoft Access Database Engine (Microsoft.ACE.OLEDB.12.0 provider) is niet geregistreerd<br>
    <p>
    <a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=13255">Download</a> Microsoft Access Database Engine (Microsoft.ACE.OLEDB.12.0 provider)
    </p>
    <div id="customForm">
        <form action="" enctype="multipart/form-data" method="post">
          <div class="form-group">
            <label for="exampleInputFile">File input</label>
            <input type="file" name="Excelfile" accept=".xlsx">
            <p class="help-block">Example block-level help text here.</p>
          </div>
         <button type="submit" class="btn btn-default">Submit</button>
            <br>
         
        </form>
    </div>
</div>

 
